


from keras.layers import Flatten, Dense, Input
from keras.models import Model
from keras import optimizers, callbacks
def __main__():
    print("something")

def run(options, input_data, output_data):
    # Encoder
    ema_inputs = Input(shape=(options["max_input_length"],options["num_features"]))
    dense_1 = Dense(options["dense_1"], activation="relu")(ema_inputs)
    flatten = Flatten()(dense_1)
    dense_2 = Dense(options["dense_2"])(flatten)
    model = Model(ema_inputs, dense_2)
    print(model.summary())
    optimiser_adam = optimizers.Adam(lr=1e-1)
    model.compile(loss="mse", optimizer=optimiser_adam)
    tb = callbacks.TensorBoard(log_dir=".logs/")
    model.fit(input_data, output_data, epochs=options["epochs"], callbacks=[tb])
    
